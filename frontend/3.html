<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack学习笔记 | quiterr的个人博客</title>
    <meta name="description" content="quiterr的个人博客">
    <link rel="icon" href="/assets/img/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.2fd3a0e5.css" as="style"><link rel="preload" href="/assets/js/app.d45e7d8d.js" as="script"><link rel="preload" href="/assets/js/3.f201c9f2.js" as="script"><link rel="preload" href="/assets/js/2.58f2d4b3.js" as="script"><link rel="preload" href="/assets/js/38.c4e1f427.js" as="script"><link rel="prefetch" href="/assets/js/10.8f6ff41b.js"><link rel="prefetch" href="/assets/js/11.d3060e6c.js"><link rel="prefetch" href="/assets/js/12.5d5dd355.js"><link rel="prefetch" href="/assets/js/13.b58b39cd.js"><link rel="prefetch" href="/assets/js/14.132da01d.js"><link rel="prefetch" href="/assets/js/15.4de3abff.js"><link rel="prefetch" href="/assets/js/16.5d01f151.js"><link rel="prefetch" href="/assets/js/17.743cc240.js"><link rel="prefetch" href="/assets/js/18.5cd47213.js"><link rel="prefetch" href="/assets/js/19.c31513f4.js"><link rel="prefetch" href="/assets/js/20.ff0c8b17.js"><link rel="prefetch" href="/assets/js/21.23bfd343.js"><link rel="prefetch" href="/assets/js/22.7b1bcdc8.js"><link rel="prefetch" href="/assets/js/23.9aa9bcc6.js"><link rel="prefetch" href="/assets/js/24.41feae7a.js"><link rel="prefetch" href="/assets/js/25.085c0a62.js"><link rel="prefetch" href="/assets/js/26.28112f5e.js"><link rel="prefetch" href="/assets/js/27.3dfa1162.js"><link rel="prefetch" href="/assets/js/28.64b59646.js"><link rel="prefetch" href="/assets/js/29.5da0daa7.js"><link rel="prefetch" href="/assets/js/30.e061c642.js"><link rel="prefetch" href="/assets/js/31.af9d5f01.js"><link rel="prefetch" href="/assets/js/32.3bb3cd16.js"><link rel="prefetch" href="/assets/js/33.28c6384b.js"><link rel="prefetch" href="/assets/js/34.e24d72db.js"><link rel="prefetch" href="/assets/js/35.066a2949.js"><link rel="prefetch" href="/assets/js/36.3605469b.js"><link rel="prefetch" href="/assets/js/37.0f0334ec.js"><link rel="prefetch" href="/assets/js/39.bf835b74.js"><link rel="prefetch" href="/assets/js/4.130bd99d.js"><link rel="prefetch" href="/assets/js/40.df4753ea.js"><link rel="prefetch" href="/assets/js/41.c0060482.js"><link rel="prefetch" href="/assets/js/42.13e0dffa.js"><link rel="prefetch" href="/assets/js/43.2a7ba197.js"><link rel="prefetch" href="/assets/js/44.4a50ce9b.js"><link rel="prefetch" href="/assets/js/45.04e3bb01.js"><link rel="prefetch" href="/assets/js/46.f860615e.js"><link rel="prefetch" href="/assets/js/47.57f7e152.js"><link rel="prefetch" href="/assets/js/48.c9adb86a.js"><link rel="prefetch" href="/assets/js/49.89d283b4.js"><link rel="prefetch" href="/assets/js/5.bc8341b3.js"><link rel="prefetch" href="/assets/js/50.176d29a8.js"><link rel="prefetch" href="/assets/js/51.73ee13f6.js"><link rel="prefetch" href="/assets/js/6.5dc22b3f.js"><link rel="prefetch" href="/assets/js/7.5d9116e6.js"><link rel="prefetch" href="/assets/js/8.ab4e4f3e.js"><link rel="prefetch" href="/assets/js/9.05f51b5b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2fd3a0e5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="quiterr的个人博客" class="logo"> <span class="site-name can-hide">quiterr的个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.jianshu.com/u/e268fe04200a" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/quiterr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.hanclouds.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hanclouds
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.jianshu.com/u/e268fe04200a" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/quiterr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.hanclouds.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hanclouds
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/architecture/" class="sidebar-heading clickable"><span>架构设计</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source/" class="sidebar-heading clickable"><span>源码阅读</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/design-pattern/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/frontend/" class="sidebar-heading clickable router-link-active open"><span>前端开发</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/" class="sidebar-link">vue2.0学习笔记</a></li><li><a href="/frontend/1.html" class="sidebar-link">问题集锦</a></li><li><a href="/frontend/2.html" class="sidebar-link">Nginx笔记</a></li><li><a href="/frontend/3.html" class="active sidebar-link">webpack学习笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/3.html#_1、环境搭建及demo" class="sidebar-link">1、环境搭建及demo</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_2、配置文件" class="sidebar-link">2、配置文件</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_3、模块：css文件打包" class="sidebar-link">3、模块：CSS文件打包</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_4、插件配置" class="sidebar-link">4、插件配置</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_5、图片迈坑" class="sidebar-link">5、图片迈坑</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_6、css进阶" class="sidebar-link">6、CSS进阶</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_7、-给webpack增加babel支持" class="sidebar-link">7、 给webpack增加babel支持</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_8、打包后如何调试" class="sidebar-link">8、打包后如何调试</a></li><li class="sidebar-sub-header"><a href="/frontend/3.html#_9、实战技巧" class="sidebar-link">9、实战技巧</a></li></ul></li><li><a href="/frontend/4.html" class="sidebar-link">Nuxt.js学习笔记</a></li><li><a href="/frontend/5.html" class="sidebar-link">ES6学习笔记</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/database/" class="sidebar-heading clickable"><span>数据库</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/collection/" class="sidebar-heading clickable"><span>资料收藏</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack学习笔记"><a href="#webpack学习笔记" class="header-anchor">#</a> webpack学习笔记</h1> <p>2019.3.24</p> <h2 id="_1、环境搭建及demo"><a href="#_1、环境搭建及demo" class="header-anchor">#</a> 1、环境搭建及demo</h2> <h3 id="_1-1-环境搭建"><a href="#_1-1-环境搭建" class="header-anchor">#</a> 1.1 环境搭建</h3> <p>由于之前学习过vue，实际已经用到了webpack，那么系统中究竟是否装过webpack呢？</p> <p>查看是否全局安装过webpack</p> <div class="language- extra-class"><pre class="language-text"><code>npm ls -g webpack
</code></pre></div><p>没有安装过，技术胖的这套教程是针对webpack 3.6.0，这里安装对应版本</p> <div class="language- extra-class"><pre class="language-text"><code>npm install -g webpack@3.6.0
</code></pre></div><p>安装有点慢，试试cnpm</p> <div class="language- extra-class"><pre class="language-text"><code>npm install cnpm -g --registry=https://registry.npm.taobao.org
cnpm install -g webpack@3.6.0
</code></pre></div><p>结果非常快。</p> <p>这个命令可以查看所有的webpack版本</p> <div class="language- extra-class"><pre class="language-text"><code>npm view webpack versions
</code></pre></div><p>新建一个webpack文件夹，项目初始化</p> <div class="language- extra-class"><pre class="language-text"><code>npm n init
</code></pre></div><p>全局安装后，还要本地安装。</p> <div class="language- extra-class"><pre class="language-text"><code>npm install -D webpack@3.6.0
</code></pre></div><p><code>-D</code>是<code>--save-dev</code>的简写</p> <p>查看版本</p> <div class="language- extra-class"><pre class="language-text"><code>webpack -v
</code></pre></div><p>其实官方并不推荐全局安装，如果只是本地安装，就不能在命令行里运行webpack命令，需要配置下package.json</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;server&quot;: &quot;webpack-dev-server&quot;,
    &quot;build&quot;:&quot;webpack&quot;
  },
</code></pre></div><p>然后就可以<code>npm run build</code>来打包了。</p> <h3 id="_1-2-demo"><a href="#_1-2-demo" class="header-anchor">#</a> 1.2 demo</h3> <p>项目根目录下建src和dist两个文件夹</p> <p>/dist/index.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>jspang webpack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./bundle.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>bundle.js文件现在还没有，用webpack执行打包命令后就会生成。</p> <p>在src文件夹下建立entry.js</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">'Hello Webpack'</span><span class="token punctuation">;</span>
</code></pre></div><p>首次打包</p> <div class="language- extra-class"><pre class="language-text"><code>webpack {entry file} {destination for bundled file}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>webpack src/entry.js dist/bundle.js
</code></pre></div><p>进到dist目录，输出live-server命令就可以打开浏览器看到结果了。</p> <h2 id="_2、配置文件"><a href="#_2、配置文件" class="header-anchor">#</a> 2、配置文件</h2> <h3 id="_2-1-入口和出口"><a href="#_2-1-入口和出口" class="header-anchor">#</a> 2.1 入口和出口</h3> <p><strong>配置文件webpack.config.js</strong></p> <p>需要自己在项目根目录下手动建立webpack.config.js</p> <p>没有内容的标准webpack配置模版</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token comment">//入口文件的配置项，支持是多入口</span>
    entry<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//出口文件的配置项，支持多出口</span>
    output<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//模块：例如解读CSS,图片如何转换，压缩</span>
    module<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//插件，用于生产模版和各项功能</span>
    plugins<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">//配置webpack开发服务功能</span>
    devServer<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>entry选项（入口配置）</strong></p> <p>这个选项就是配置我们要压缩的文件一般是JavaScript文件（当然也可以是CSS…..）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//入口文件的配置项</span>
entry<span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token comment">//里面的entery是可以随便写的</span>
    entry<span class="token punctuation">:</span><span class="token string">'./src/entry.js'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p><strong>output选项（出口配置）</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//出口文件的配置项</span>
output<span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token comment">//打包的路径文职</span>
    path<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">//打包的文件名称</span>
    filename<span class="token punctuation">:</span><span class="token string">'bundle.js'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>这里用到了node的代码，先用就行了。</p> <p>如果只这样写，会报错：找不到path。所以我们要在webpack.config.js的头部引入path</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>打包</strong></p> <div class="language- extra-class"><pre class="language-text"><code>webpack
</code></pre></div><p>这里报了一个错</p> <div class="language- extra-class"><pre class="language-text"><code>TypeError: &quot;require&quot; is not a function
</code></pre></div><p>花了一些时间，发现是package.json中配置的webpack的版本号不对</p> <p>原来是1.0.0，改成3.6.0并重新cnpm install就可以了。</p> <p><strong>多入口、多出口配置</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const path = require('path');
module.exports={
    //入口文件的配置项
    entry:{
        entry:'./src/entry.js',
        //这里我们又引入了一个入口文件
        entry2:'./src/entry2.js'
    },
    //出口文件的配置项
    output:{
        //输出的路径，用了Node语法
        path:path.resolve(__dirname,'dist'),
        //输出的文件名称
        filename:'[name].js'
    },
    //模块：例如解读CSS,图片如何转换，压缩
    module:{},
    //插件，用于生产模版和各项功能
    plugins:[],
    //配置webpack开发服务功能
    devServer:{}
}
</code></pre></div><p>entry配置项增加了一个entry2.js的入口文件，原来的bundle.js修改成了<code>[name].js</code>。</p> <h3 id="_2-2-服务和热更新"><a href="#_2-2-服务和热更新" class="header-anchor">#</a> 2.2 服务和热更新</h3> <p><strong>设置webpack-dev-server</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev webpack-dev-server
</code></pre></div><p>报错说要求webpack4.0以上版本</p> <p>从https://www.npmjs.com/package/webpack-dev-server站点上可以查到相应的版本号</p> <p>重新安装</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev webpack-dev-server@2.11.3
</code></pre></div><p>报错</p> <div class="language- extra-class"><pre class="language-text"><code>peerDependencies WARNING webpack-dev-server@2.11.3 requires a peer of webpack@^2.2.0 || ^3.0.0 but none was installed
</code></pre></div><p>需要在package.json文件中配置并重新执行cnpm install、重新安装webpack-dev-server</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;devDependencies&quot;: {
    &quot;webpack&quot;: &quot;3.6.0&quot;
  }
</code></pre></div><p>之后在webpack.config.js中配置</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token punctuation">:</span><span class="token punctuation">{</span>
        <span class="token comment">//设置基本目录结构</span>
        contentBase<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">//服务器的IP地址，可以使用IP也可以使用localhost</span>
        host<span class="token punctuation">:</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
        <span class="token comment">//服务端压缩是否开启</span>
        compress<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">//配置服务端口号</span>
        port<span class="token punctuation">:</span><span class="token number">1717</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>不能直接执行webpack-dev-server，因为我们只是本地安装，没有全局安装</p> <p>在package.json里配置一下scripts选项</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;server&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;webpack-dev-server&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>执行</p> <div class="language- extra-class"><pre class="language-text"><code>npm run server
</code></pre></div><p>如果前面那个<code>peerDependencies WARNING</code>这时又会报错</p> <div class="language- extra-class"><pre class="language-text"><code>Cannot find module 'webpack'
</code></pre></div><p>所有的问题解决后，总算一切正常了。</p> <h2 id="_3、模块：css文件打包"><a href="#_3、模块：css文件打包" class="header-anchor">#</a> 3、模块：CSS文件打包</h2> <p>Webpack在生产环境中有一个重要的作用就是减少http的请求数，就是把多个文件打包到一个js里，这样请求数就可以减少很多。这节学习CSS文件打包。先了解下webpack.config.js里的Loaders配置项。</p> <p><strong>Loaders</strong></p> <p>Loaders是Webpack最重要的功能之一，他也是Webpack如此盛行的原因。</p> <p>简单的举几个Loaders使用例子：</p> <ul><li>可以把SASS文件的写法转换成CSS，而不再使用其他转换工具。</li> <li>可以把ES6或者ES7的代码，转换成大多浏览器兼容的JS代码。</li> <li>可以把React中的JSX转换成JavaScript代码。</li></ul> <p>注意：所有的Loaders都需要在npm中单独进行安装，并在webpack.config.js里进行配置。下面我们对Loaders的配置型简单梳理一下。</p> <ul><li>test：用于匹配处理文件的扩展名的表达式，这个选项是必须进行配置的；</li> <li>use：loader名称，就是你要使用模块的名称，这个选项也必须进行配置，否则报错；</li> <li>include/exclude:手动添加必须处理的文件（文件夹）或屏蔽不需要处理的文件（文件夹）（可选）；</li> <li>query：为loaders提供额外的设置选项（可选）。</li></ul> <p>下面进入正题，如何打包CSS文件。</p> <p><strong>打包CSS文件：</strong></p> <p>在/src目录下，建立一个css文件夹，在文件夹里建立index.css文件。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body</span><span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>引入到entry.js中</p> <div class="language- extra-class"><pre class="language-text"><code>import css from './css/index.css';
</code></pre></div><p><strong>style-loader:</strong></p> <p>它是用来处理css文件中的url()等，<a href="https://www.npmjs.com/package/css-loader" target="_blank" rel="noopener noreferrer">style-loader介绍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev style-loader
</code></pre></div><p><strong>css-loader：</strong></p> <p><a href="https://www.npmjs.com/package/css-loader" target="_blank" rel="noopener noreferrer">css-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 把<code>@import</code> 和<code>url()</code> 解释成 <code>import/require()</code></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev css-loader
</code></pre></div><p>安装时出现</p> <div class="language- extra-class"><pre class="language-text"><code>peerDependencies WARNING css-loader@* requires a peer of webpack@^4.0.0 but webpack@3.6.0 was installed
</code></pre></div><p>重新安装老版本</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install -D css-loader@0.28.0
</code></pre></div><p><strong>loaders配置：</strong></p> <p>修改webpack.config.js中module属性中的配置代码</p> <div class="language- extra-class"><pre class="language-text"><code>module:{
        rules: [
            {
              test: /\.css$/,
              use: [ 'style-loader', 'css-loader' ]
            }
          ]
    },
</code></pre></div><p>第二种写法</p> <div class="language- extra-class"><pre class="language-text"><code>module:{
        rules:[
            {
                test:/\.css$/,
                loader:['style-loader','css-loader']
            }
        ]
    },
</code></pre></div><p>第三种写法</p> <div class="language- extra-class"><pre class="language-text"><code>module:{
        rules:[
            {
                test:/\.css$/,
                use: [
                    {
                        loader: &quot;style-loader&quot;
                    }, {
                        loader: &quot;css-loader&quot;
                    }
                ]
            }
        ]
    },
</code></pre></div><h2 id="_4、插件配置"><a href="#_4、插件配置" class="header-anchor">#</a> 4、插件配置</h2> <h3 id="_4-1-配置js压缩"><a href="#_4-1-配置js压缩" class="header-anchor">#</a> 4.1 配置JS压缩</h3> <p>webpack默认集成了uglifyjs-webpack-plugin，负责js文件的压缩。</p> <p>在webpack.config.js中引入uglifyjs-webpack-glugin</p> <div class="language- extra-class"><pre class="language-text"><code>const uglify = require('uglifyjs-webpack-plugin');
</code></pre></div><p>在plugins配置里new一个 uglify对象就可以了</p> <div class="language- extra-class"><pre class="language-text"><code>plugins:[
        new uglify()
    ],
</code></pre></div><p>使用webpack命令打包就会发现生成的js已经压缩了。</p> <h3 id="_4-2-html文件的发布"><a href="#_4-2-html文件的发布" class="header-anchor">#</a> 4.2 HTML文件的发布</h3> <p>有经验的小伙伴其实一眼就可以看出，我们把index.html直接放到了dist文件夹下是不正确的，应该放到src目录下，前面只是为了方便学习。</p> <p><strong>devServer和JS压缩的冲突</strong></p> <p>devServer用于开发环境，JS压缩用于生产环境，一般在正式开发时都有多个webpack配置文件。</p> <p><strong>打包HTML文件</strong></p> <p>先把dist中的html文件剪切到src目录中，并去掉我们的JS引入代码（webpack会自动为我们引入JS），因为这才是我们真实工作的目录文件结构。</p> <p>配置webpack.config.js文件，先引入我们的html-webpack-plugin插件</p> <div class="language- extra-class"><pre class="language-text"><code>const htmlPlugin= require('html-webpack-plugin');
</code></pre></div><p>使用npm进行安装</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev html-webpack-plugin
</code></pre></div><p>最后在webpack.config.js里的plugins里进行插件配置</p> <div class="language- extra-class"><pre class="language-text"><code>new htmlPlugin({
            minify:{
                removeAttributeQuotes:true
            },
            hash:true,
            template:'./src/index.html'
        })
</code></pre></div><ul><li>minify：是对html文件进行压缩，removeAttrubuteQuotes是却掉属性的双引号。</li> <li>hash：开发中js有缓存效果，所以加入hash，这样可以有效避免缓存JS。</li> <li>template：是要打包的html模版路径和文件名称。</li></ul> <p>在终端中使用webpack进行打包。正常的话可以看到index.html文件已经被打包到dist目录下了，并且自动为我们引入了路口的JS文件。</p> <h2 id="_5、图片迈坑"><a href="#_5、图片迈坑" class="header-anchor">#</a> 5、图片迈坑</h2> <h3 id="_5-1-css中的图片处理"><a href="#_5-1-css中的图片处理" class="header-anchor">#</a> 5.1 CSS中的图片处理</h3> <p>有时是在开发环境中可以找到图片，但是一打包后就找不到图片了，另一种情况是压根不知道如何正确引入图片。</p> <p><strong>图片写入CSS</strong></p> <p>在src目录下新建一个images文件夹，把图片放入images文件夹。</p> <p>在\src\index.html文件中增加一个放置div的标签</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tupian<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>编写css文件，把图片作为背景显示。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">#tupian</span><span class="token punctuation">{</span>
   <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../images/hello.png<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
   <span class="token property">width</span><span class="token punctuation">:</span>466px<span class="token punctuation">;</span>
   <span class="token property">height</span><span class="token punctuation">:</span>453px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>file-loader、url-loader</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev file-loader@2.0.0
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev url-loader@0.5.9
</code></pre></div><p>**file-loader：**解决引用路径的问题，拿background样式用url引入背景图来说，我们都知道，webpack最终会将各个模块打包成一个文件，因此我们样式中的url路径是相对入口html页面的，而不是相对于原始css文件所在的路径的。这就会导致图片引入失败。这个问题是用file-loader解决的，file-loader可以解析项目中的url引入（不仅限于css），根据我们的配置，将图片拷贝到相应的路径，再根据我们的配置，修改打包后文件引用路径，使之指向正确的文件。</p> <p>**url-loader：**如果图片较多，会发很多http请求，会降低页面性能。这个问题可以通过url-loader解决。url-loader会将引入的图片编码，生成dataURl。相当于把图片数据翻译成一串字符。再把这串字符打包到文件中，最终只需要引入这个文件就能访问图片了。当然，如果图片较大，编码会消耗性能。因此url-loader提供了一个limit参数，小于limit字节的文件会被转为DataURl，大于limit的还会使用file-loader进行copy。</p> <p><strong>配置url-loader</strong></p> <p>webpack.config.js文件</p> <div class="language- extra-class"><pre class="language-text"><code>//模块：例如解读CSS,图片如何转换，压缩
    module:{
        rules: [
            {
              test: /\.css$/,
              use: [ 'style-loader', 'css-loader' ]
            },{
               test:/\.(png|jpg|gif)/ ,
               use:[{
                   loader:'url-loader',
                   options:{
                       limit:500000
                   }
               }]
            }
          ]
    },
</code></pre></div><p><strong>为什么只使用了url-loader</strong></p> <p>简答地说，url-loader封装了file-loader。url-loader不依赖于file-loader，即使用url-loader时，只需要安装url-loader即可，不需要安装file-loader，因为url-loader内置了file-loader。通过上面的介绍，我们可以看到，url-loader工作分两种情况：</p> <p>1.文件大小小于limit参数，url-loader将会把文件转为DataURL（Base64格式）；</p> <p>2.文件大小大于limit，url-loader会调用file-loader进行处理，参数也会直接传给file-loader。</p> <p>也就是说，其实我们只安装一个url-loader就可以了。但是为了以后的操作方便，我们这里就顺便安装上file-loader。</p> <p><strong>把图片放到指定的文件夹下</strong></p> <p>例如放到images文件夹下，只需要配置url-loader选项就可以了。</p> <div class="language- extra-class"><pre class="language-text"><code>use: [{
	loader: 'url-loader',
	options: {
		limit: 500000,
		outputPath:'images/'
	}
}]
</code></pre></div><h3 id="_5-2-css分离与图片路径处理"><a href="#_5-2-css分离与图片路径处理" class="header-anchor">#</a> 5.2 CSS分离与图片路径处理</h3> <p>这节两个主要知识：第一个是把CSS从JavasScript代码中分离出来，第二个是如何处理分离出来后CSS中的图片路径不对问题。</p> <p><strong>CSS分离:extract-text-webpack-plugin</strong></p> <p>有些简单的交互页面中，你的JavasScript页面代码会非常少，而大部分代码都在CSS中，这时候项目组长会要求把CSS单独提取出来，方便以后更改。</p> <p>webpack官方建议CSS打包到JavasScript当中以减少http的请求数。但现实中的需求往往不是我们前端能控制的，分离CSS就是这样一个既合理由不合理的需求。</p> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev extract-text-webpack-plugin@3.0.0
</code></pre></div><p>引入</p> <div class="language- extra-class"><pre class="language-text"><code>const extractTextPlugin = require(&quot;extract-text-webpack-plugin&quot;);
</code></pre></div><p>设置Plugins</p> <div class="language- extra-class"><pre class="language-text"><code>new extractTextPlugin(&quot;/css/index.css&quot;)
</code></pre></div><p>这里的/css/index.css是分离后的路径位置。还要修改原来的style-loader和css-loader。</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">:</span><span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
              use<span class="token punctuation">:</span> extractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                fallback<span class="token punctuation">:</span> <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token string">&quot;css-loader&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
               test<span class="token punctuation">:</span><span class="token regex">/\.(png|jpg|gif)/</span> <span class="token punctuation">,</span>
               use<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
                   loader<span class="token punctuation">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
                   options<span class="token punctuation">:</span><span class="token punctuation">{</span>
                       limit<span class="token punctuation">:</span><span class="token number">500000</span>
                   <span class="token punctuation">}</span>
               <span class="token punctuation">}</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>最后就是webpack打包了。</p> <p><strong>图片路径问题：</strong></p> <p>上边已经成功将css分离出来了，但是图片并没有显示出来，这是因为路径有问题，需要配置下publicPath。</p> <p>publicPath在webpack.config.js文件的output选项中，主要作用就是处理静态文件路径。</p> <div class="language- extra-class"><pre class="language-text"><code>//出口文件的配置项
    output:{
        //输出的路径，用了Node语法
        path:path.resolve(__dirname,'dist'),
        //输出的文件名称
        filename:'[name].js',
        publicPath:&quot;http://localhost:1717/&quot;
    },
</code></pre></div><p>注意这里的IP和端口，保持和devServer或live-server一致。</p> <h3 id="_5-3-处理html中的图片"><a href="#_5-3-处理html中的图片" class="header-anchor">#</a> 5.3 处理HTML中的图片</h3> <p>webpack不建议用标签来引入图片，但是我们作前端的人特别热衷于这种写法，国人也为此开发了一个：html-withimg-loader，这是一个小众插件。</p> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev html-withimg-loader@0.1.16
</code></pre></div><p>注意：有时候输错版本号，cnpm没反应？比如0.1.16输错成0.1.6，npm没有这问题。另外，有时候uninstall一些模块的时候会把别的需要的模块也uninstall了，只需要npm install一下就好了。</p> <p>在/src/index.html下用img标签引入图片</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;body&gt;
    &lt;div id=&quot;title&quot;&gt;&lt;/div&gt;
    &lt;div id=&quot;tupian&quot;&gt;&lt;/div&gt;
    &lt;div&gt;&lt;img src=&quot;./images/hello.png&quot;  alt=&quot;厦门长隆旅游&quot; /&gt;&lt;/div&gt;
&lt;/body&gt;
</code></pre></div><p>修改webpack.config.js</p> <div class="language- extra-class"><pre class="language-text"><code>{
    test: /\.(htm|html)$/i,
    use:[ 'html-withimg-loader'] 
}
</code></pre></div><p>最后就是打包了。</p> <h2 id="_6、css进阶"><a href="#_6、css进阶" class="header-anchor">#</a> 6、CSS进阶</h2> <h3 id="_6-1-less文件的打包和分离"><a href="#_6-1-less文件的打包和分离" class="header-anchor">#</a> 6.1 Less文件的打包和分离</h3> <p><strong>安装less</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev less
</code></pre></div><p><strong>index.html中加一个div</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;div id=&quot;gogo&quot;&gt;&lt;/div&gt;
</code></pre></div><p><strong>编写一个less文件</strong></p> <div class="language-less extra-class"><pre class="language-less"><code><span class="token variable">@base <span class="token punctuation">:</span></span>#000<span class="token punctuation">;</span>
<span class="token selector">#gogo</span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span>300px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span>300px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span><span class="token variable">@base</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>引入到entery.js文件中</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> less <span class="token keyword">from</span> <span class="token string">'./css/black.less'</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>安装配置loader</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev less-loader
</code></pre></div><p>安装好后，需要在webpack.config.js里编写loader配置，当然要想正确解析成CSS，还是需要style-loader和css-loader的帮助。</p> <div class="language- extra-class"><pre class="language-text"><code>{
	test: /\.less$/,
	use: [{
		loader: &quot;style-loader&quot; // creates style nodes from JS strings
	}, {
		loader: &quot;css-loader&quot; // translates CSS into CommonJS
	}, {
		loader: &quot;less-loader&quot; // compiles Less to CSS
	}]
}
</code></pre></div><p><strong>打包</strong></p> <div class="language- extra-class"><pre class="language-text"><code>npm run build
</code></pre></div><p><strong>把Lees文件分离。</strong></p> <p>仍然是用extract-text-webpack-plugin这个插件</p> <div class="language- extra-class"><pre class="language-text"><code>{
	test: /\.less$/,
	use: extractTextPlugin.extract({
		use: [{
			loader: &quot;css-loader&quot;
		}, {
			loader: &quot;less-loader&quot;
		}],
		// use style-loader in development
		fallback: &quot;style-loader&quot;
	})
}
</code></pre></div><p>如果不改原来的插件配置</p> <div class="language- extra-class"><pre class="language-text"><code>new extractTextPlugin(&quot;/css/index.css&quot;)
</code></pre></div><p>那么所有的css、less文件都会打包到一个index.css中。</p> <p><a href="https://segmentfault.com/q/1010000011058648/a-1020000011058890" target="_blank" rel="noopener noreferrer">多个css文件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这篇文章给了一个办法。</p> <h3 id="_6-2-sass文件的打包和分离"><a href="#_6-2-sass文件的打包和分离" class="header-anchor">#</a> 6.2 SASS文件的打包和分离</h3> <p><strong>编写一个Sass文件</strong></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token property"><span class="token variable">$nav-color</span></span><span class="token punctuation">:</span> #FFF<span class="token punctuation">;</span>
<span class="token selector">#nav </span><span class="token punctuation">{</span>
  <span class="token property"><span class="token variable">$width</span></span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token variable">$width</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span>30px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token variable">$nav-color</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>安装SASS打包的loader</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev node-sass
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev sass-loader
</code></pre></div><p><strong>编写loader配置</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
                test: /\.scss$/,
                use: [{
                    loader: &quot;style-loader&quot; // creates style nodes from JS strings
                }, {
                    loader: &quot;css-loader&quot; // translates CSS into CommonJS
                }, {
                    loader: &quot;sass-loader&quot; // compiles Sass to CSS
                }]
}
</code></pre></div><p>打包以及分离和less一样，这里不再重复了。</p> <h3 id="_6-3-自动处理css3属性前缀"><a href="#_6-3-自动处理css3属性前缀" class="header-anchor">#</a> 6.3 自动处理CSS3属性前缀</h3> <p>虽然在<code>can i use</code>网上上可以查到哪些CSS属性该加浏览器前缀，但是这样效率太低。这节介绍用<code>postcss-loader</code>自动加前缀。</p> <p><strong>安装postcss</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev postcss-loader autoprefixer
</code></pre></div><p><strong>配置</strong></p> <p>在项目根目录建立一个postcss.config.js文件。</p> <div class="language- extra-class"><pre class="language-text"><code>module.exports = {
    plugins: [
        require('autoprefixer')
    ]
}
</code></pre></div><p><strong>编写loader</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
      test: /\.css$/,
      use: [
            {
              loader: &quot;style-loader&quot;
            }, {
              loader: &quot;css-loader&quot;,
              options: {
                 modules: true
              }
            }, {
              loader: &quot;postcss-loader&quot;
            }
      ]
}
</code></pre></div><p><strong>分离css</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
	test: /\.css$/,
	use: extractTextPlugin.extract({
		fallback: &quot;style-loader&quot;,
		use: [&quot;css-loader&quot;, &quot;postcss-loader&quot;]
	})
}
</code></pre></div><p><a href="https://github.com/postcss/postcss-loader" target="_blank" rel="noopener noreferrer">postcss-loader官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_6-4-消除未使用的css"><a href="#_6-4-消除未使用的css" class="header-anchor">#</a> 6.4 消除未使用的CSS</h3> <p>像Bootstrap这样的框架往往会带有很多CSS。在项目中通常我们只使用它的一小部分。就算我们自己写CSS，随着项目的进展，CSS也会越来越多，有时候需求更改，带来了DOM结构的更改，这时候我们可能无暇关注CSS样式，造成很多CSS的冗余。这节学习用webpack消除未使用的CSS。</p> <p><strong>安装PurifyCSS-webpack</strong></p> <p>这是一个插件，而不是loader，所以这个需要安装还需要引入。</p> <p>PurifyCSS-webpack依赖于purify-css。</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm  i -D purifycss-webpack purify-css
</code></pre></div><p><strong>引入glob</strong></p> <p>因为我们需要同步检查html模板，所以我们需要引入node的glob对象使用。在webpack.config.js文件头部引入glob。</p> <div class="language- extra-class"><pre class="language-text"><code>const glob = require('glob');
const PurifyCSSPlugin = require(&quot;purifycss-webpack&quot;);
</code></pre></div><p><strong>配置plugins</strong></p> <div class="language- extra-class"><pre class="language-text"><code>new PurifyCSSPlugin({
	// Give paths to parse for rules. These should be absolute!
	paths: glob.sync(path.join(__dirname, 'src/*.html')),
})
</code></pre></div><p>**注意：**使用这个插件必须配合extract-text-webpack-plugin这个插件</p> <h2 id="_7、-给webpack增加babel支持"><a href="#_7、-给webpack增加babel支持" class="header-anchor">#</a> 7、 给webpack增加babel支持</h2> <p><strong>Babel的安装与配置</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev @babel/core babel-loader @babel/preset-env @babel/preset-react
</code></pre></div><p><strong>在webpack中配置Babel</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
    test:/\.(jsx|js)$/,
    use:{
        loader:'babel-loader',
        options:{
            presets:[
                &quot;@babel/preset-env&quot;, &quot;@babel/preset-react&quot;
            ]
        }
    },
    exclude:/node_modules/
}
</code></pre></div><p>修改一下entry.js试试</p> <div class="language- extra-class"><pre class="language-text"><code>import css from './css/index.css';
{
    let jspangString = 'Hello Webpack'
    document.getElementById('title').innerHTML=jspangString; 
}
</code></pre></div><p><strong>.babelrc配置</strong></p> <p>Babel的配置非常多，最好单独写在自己的配置文件中。</p> <p>.babelrc</p> <div class="language- extra-class"><pre class="language-text"><code>presets: [
	&quot;@babel/preset-env&quot;, &quot;@babel/preset-react&quot;
]
</code></pre></div><p>.webpack.config.js你的babel loader的options就可以不要了。</p> <h2 id="_8、打包后如何调试"><a href="#_8、打包后如何调试" class="header-anchor">#</a> 8、打包后如何调试</h2> <p>在使用webpack时通过配置devtool，webapck就会自动生成source maps 文件，map文件是一种对应编译文件和源文件的方法，让我们调试起来更简单。</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devtool<span class="token punctuation">:</span> <span class="token string">'eval-source-map'</span><span class="token punctuation">,</span>
  entry<span class="token punctuation">:</span>  __dirname <span class="token operator">+</span> <span class="token string">&quot;/app/main.js&quot;</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">&quot;/public&quot;</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">&quot;bundle.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p><strong>source-map：</strong></p> <p>在一个单独文件中产生一个完整且功能完全的文件。这个文件具有最好的source map，但是它会减慢打包速度；</p></li> <li><p><strong>cheap-module-source-map：</strong></p> <p>在一个单独的文件中产生一个不带列映射的map，不带列映射提高了打包速度，但是也使得浏览器开发者工具只能对应到具体的行，不能对应到具体的列（符号），会对调试造成不便。</p></li> <li><p><strong>eval-source-map：</strong></p> <p>使用eval打包源文件模块，在同一个文件中生成干净的完整版source map，但是对打包后输出的JS文件的执行具有性能和安全的隐患。在开发阶段这是一个非常好的选项，在生产阶段则一定要不开启这个选项。</p></li> <li><p><strong>cheap-module-eval-source-map：</strong></p> <p>这是在打包文件时最快的生成source map的方法，生成 Source map 会和打包后的JavaScript文件同行显示，没有影射列，和eval-source-map选项具有相似的缺点。</p></li></ul> <p>四种打包模式，从上到下打包速度越来越快，不过同时也具有越来越多的负面作用，较快的打包速度的后果就是对执行和调试有一定的影响。</p> <p>个人意见是，如果大型项目可以使用source-map，如果是中小型项目使用eval-source-map就完全可以应对，需要强调说明的是，source map只适用于开发阶段，上线前记得修改这些调试设置。</p> <p><a href="https://www.cnblogs.com/axl234/p/6500534.html" target="_blank" rel="noopener noreferrer">参考文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_9、实战技巧"><a href="#_9、实战技巧" class="header-anchor">#</a> 9、实战技巧</h2> <h3 id="_9-1-开发和生产并行设置"><a href="#_9-1-开发和生产并行设置" class="header-anchor">#</a> 9.1 开发和生产并行设置</h3> <p><strong>npm安装的三种方式</strong></p> <p><strong>第一种：</strong></p> <div class="language-mipsasm extra-class"><pre class="language-text"><code>npm install jquery
</code></pre></div><p>安装完成后，你会发现在package.json中并不存在这个包的依赖。如果你项目拷贝给别人继续开发，或者别人和你git合作，再次下载项目npm install时就会缺少这个jquery包。项目就会无法正常运行，所以这也是我们最不赞成的安装方法。</p> <p><strong>第二种：</strong></p> <div class="language-mipsasm extra-class"><pre class="language-text"><code>npm install jquery --save
</code></pre></div><p>安装完成后，它存在于package.json的dependencies中，也就是说它是生产环境需要依赖的包（上线时需要的以来包）。</p> <p><strong>第三种：</strong></p> <div class="language-mipsasm extra-class"><pre class="language-text"><code>npm install jquery --save-dev
</code></pre></div><p>安装完成后，它存在于package.json的devDependencies中，也就是说它是开发环境中需要的，上线并不需要这个包的依赖。</p> <p><strong>安装全部项目依赖包：</strong></p> <div class="language-cmake extra-class"><pre class="language-cmake"><code>npm install
</code></pre></div><p>安装生产环境依赖包：</p> <div class="language-sql extra-class"><pre class="language-sql"><code>npm install <span class="token comment">--production</span>
</code></pre></div><p><strong>配置生产和开发并行</strong></p> <p>修改package.json</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;server&quot;: &quot;webpack-dev-server --open&quot;,
    &quot;dev&quot;:&quot;set type=dev&amp;webpack&quot;,
    &quot;build&quot;: &quot;set type=build&amp;webpack&quot;
  },
</code></pre></div><p>修改webpack.config.js文件</p> <div class="language- extra-class"><pre class="language-text"><code>if(process.env.type== &quot;build&quot;){
    var website={
        publicPath:&quot;http://192.168.0.104:1717/&quot;
    }
}else{
    var website={
        publicPath:&quot;http://cdn.jspang.com/&quot;
    }
}
</code></pre></div><h3 id="_9-2-webpack模块化配置"><a href="#_9-2-webpack模块化配置" class="header-anchor">#</a> 9.2 webpack模块化配置</h3> <p>在根目录，新建一个webpack_config文件夹，然后新建entry_webpack.js文件</p> <div class="language- extra-class"><pre class="language-text"><code>//声明entry变量
const entry ={};  
//声明路径属性
entry.path={
    entry:'./src/entry.js'  
}
//进行模块化
module.exports =entry;
</code></pre></div><p>在webpack.config.js中引入</p> <div class="language- extra-class"><pre class="language-text"><code>const entry = require(&quot;./webpack_config/entry_webpack.js&quot;)
</code></pre></div><p>然后在入口文件部分，修改成如下代码：</p> <div class="language- extra-class"><pre class="language-text"><code>entry:entry.path,
</code></pre></div><p>注意，按照这个做实际报错了，了解思路就行了。</p> <h3 id="_9-3-优雅打包第三方类库"><a href="#_9-3-优雅打包第三方类库" class="header-anchor">#</a> 9.3 优雅打包第三方类库</h3> <p>以JQuery为例</p> <p>安装JQuery</p> <div class="language-mipsasm extra-class"><pre class="language-text"><code>cnpm install --save jquery
</code></pre></div><p>引入到entry.js</p> <div class="language- extra-class"><pre class="language-text"><code>import $ from 'jquery';
</code></pre></div><p>使用jquery</p> <div class="language- extra-class"><pre class="language-text"><code>$('#title').html('Hello JSpang');
</code></pre></div><p>不仅可以在entry.js中进行引入，还可以在任何需要的js中引入，webpack不会重复打包，它只打包一次。</p> <p><strong>用plugin引入</strong></p> <p>使用webpack自带的插件ProvidePlugin</p> <div class="language- extra-class"><pre class="language-text"><code>const  webpack = require('webpack');
</code></pre></div><p>配置plugins模块</p> <div class="language- extra-class"><pre class="language-text"><code>plugins:[
    new webpack.ProvidePlugin({
        $:&quot;jquery&quot;
    })
],
</code></pre></div><h3 id="_9-4-watch的正确使用方法"><a href="#_9-4-watch的正确使用方法" class="header-anchor">#</a> 9.4 watch的正确使用方法</h3> <div class="language- extra-class"><pre class="language-text"><code>watchOptions:{
    //检测修改的时间，以毫秒为单位
    poll:1000, 
    //防止重复保存而发生重复编译错误。这里设置的500是半秒内重复保存，不进行打包操作
    aggregateTimeout:500, 
    //不监听的目录
    ignored:/node_modules/, 
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>webpack --watch
</code></pre></div><p><strong>BannerPlugin插件</strong></p> <div class="language- extra-class"><pre class="language-text"><code>new webpack.BannerPlugin('JSPang版权所有，看官方免费视频到jspang.com收看')
</code></pre></div><p>需要注意的是在使用这个插件之前必须引入webpack。</p> <h3 id="_9-5-webpack优化黑技能"><a href="#_9-5-webpack优化黑技能" class="header-anchor">#</a> 9.5 webpack优化黑技能</h3> <p><strong>ProvidePlugin和import</strong></p> <p>之前学习了如何引入第三方类库，并引入了jquery，在引用JQuery时我们用了两种方法，第一种时import，第二种时使用ProvidePlugin插件。两种引入方法区别</p> <ul><li>import引入方法：引用后不管你在代码中是否该类库，都会把该类库打包起来，这样有时就会让代码产生冗余。</li> <li>ProvidePlugin引入方法：引用后只有在类库使用时，才按需进行打包，所以建议在工作使用插件的方式进行引入。</li></ul> <p><strong>抽离JQuery</strong></p> <p>上边的方法只是优化的第一步，工作中不用的类库我们也不会引入。</p> <p>第一步：修改入口文件</p> <p>webpack.config.js</p> <div class="language- extra-class"><pre class="language-text"><code>entry:{
        entry:'./src/entry.js',
        jquery:'jquery'
 },
</code></pre></div><p>第二步：引入optimize插件</p> <div class="language- extra-class"><pre class="language-text"><code>new webpack.optimize.CommonsChunkPlugin({
    //name对应入口文件中的名字，我们起的是jQuery
    name:'jquery',
    //把文件打包到哪里，是一个路径
    filename:&quot;assets/js/jquery.min.js&quot;,
    //最小打包的文件模块数，这里直接写2就好
    minChunks:2
}),
</code></pre></div><p>filename是可以省略的，默认直接打包到根目录dist下。</p> <p>配置完成后，先删掉以前打包的dist目录，然后用webpack再次打包，会发现jquery被抽离了出来，并且entry.js文件变的很小。</p> <p><strong>多个第三方类库抽离</strong></p> <p>在实际开发中，引用不止一个第三方类库，以引入Vue为例，看看如何抽离出来。</p> <p>先安装vue</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install vue --save
</code></pre></div><p>在入口配置中引入vue和jquery</p> <div class="language- extra-class"><pre class="language-text"><code>entry:{
    entry:'./src/entry.js',
    jquery:'jquery',
    vue:'vue'
},
</code></pre></div><p>修改CommonsChunkPlugin配置</p> <div class="language- extra-class"><pre class="language-text"><code>new webpack.optimize.CommonsChunkPlugin({
    //name对应入口文件中的名字，我们起的是jQuery
    name:['jquery','vue'],
    //把文件打包到哪里，是一个路径
    filename:&quot;assets/js/[name].js&quot;,
    //最小打包的文件模块数，这里直接写2就好
    minChunks:2
}),
</code></pre></div><h3 id="_9-6-静态资源集中输出"><a href="#_9-6-静态资源集中输出" class="header-anchor">#</a> 9.6 静态资源集中输出</h3> <p>项目根目录下新建public文件夹，放入一张图片。</p> <p>安装copy-webpack-plugin插件</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install --save-dev copy-webpack-plugin@4.0.1
</code></pre></div><p>在webpack.config.js文件的头部引入插件</p> <div class="language-ebnf extra-class"><pre class="language-ebnf"><code><span class="token definition rule keyword">const copyWebpackPlugin</span> <span class="token operator">=</span> <span class="token rule">require</span><span class="token punctuation">(</span><span class="token string">&quot;copy-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在plugins里边配置插件</p> <div class="language- extra-class"><pre class="language-text"><code>new copyWebpackPlugin([{
        from:__dirname+'/src/public',
        to:'./public'
    }])
</code></pre></div><ul><li>from:要打包的静态资源目录地址，这里的__dirname是指项目目录下，是node的一种语法，可以直接定位到本机的项目目录中。</li> <li>to:要打包到的文件夹路径，跟随output配置中的目录。所以不需要再自己加__dirname。</li></ul> <h3 id="_9-7-json配置文件使用"><a href="#_9-7-json配置文件使用" class="header-anchor">#</a> 9.7 JSON配置文件使用</h3> <p>项目中经常用到JSON配置文件，在webpack1或者webpack2版本中，需要加载json-loader，但是在webpack3.x版本中，不再需要另外引入了。</p> <p>项目根目录下新建config.json</p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;name&quot;:&quot;hello&quot;
}
</code></pre></div><p>index.html</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;div id=&quot;json&quot;&gt;&lt;/div&gt;
</code></pre></div><p>entry.js</p> <div class="language- extra-class"><pre class="language-text"><code>var json =require('../config.json');
document.getElementById(&quot;json&quot;).innerHTML= json.name;
</code></pre></div><p>打包即可看到效果。</p> <p><strong>热更新</strong></p> <div class="language- extra-class"><pre class="language-text"><code>new webpack.HotModuleReplacementPlugin()
</code></pre></div><p>这里的更新是重新刷新了页面，而不是Vue的局部刷新。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/14/2020, 11:43:09 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend/2.html" class="prev">
        Nginx笔记
      </a></span> <span class="next"><a href="/frontend/4.html">
        Nuxt.js学习笔记
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d45e7d8d.js" defer></script><script src="/assets/js/3.f201c9f2.js" defer></script><script src="/assets/js/2.58f2d4b3.js" defer></script><script src="/assets/js/38.c4e1f427.js" defer></script>
  </body>
</html>
